<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halaman Transaksi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #pelangganUmumDiv {
            display: none;
        }
        #pelangganMemberDiv {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Halaman Transaksi</h2>

        <!-- Form Transaksi -->
        <form id="transaksiForm">
            <!-- Pilih Kategori Pelanggan -->
            <div class="mb-3">
                <label for="kategoriPelanggan" class="form-label">Kategori Pelanggan</label>
                <select class="form-select" id="kategoriPelanggan" required>
                    <option value="" disabled selected>Pilih Kategori</option>
                    <option value="Umum">Umum</option>
                    <option value="Member">Member</option>
                </select>
            </div>

            <!-- Data Pelanggan Umum -->
            <div id="pelangganUmumDiv">
                <div class="mb-3">
                    <label for="namaUmum" class="form-label">Nama</label>
                    <input type="text" class="form-control" id="namaUmum" placeholder="Masukkan Nama">
                </div>
                <div class="mb-3">
                    <label for="noHpUmum" class="form-label">Nomor HP</label>
                    <input type="text" class="form-control" id="noHpUmum" placeholder="Masukkan Nomor HP">
                </div>
                <div class="mb-3">
                    <label for="alamatUmum" class="form-label">Alamat (Opsional)</label>
                    <textarea class="form-control" id="alamatUmum" placeholder="Masukkan Alamat"></textarea>
                </div>
            </div>

            <!-- Data Pelanggan Member -->
            <div id="pelangganMemberDiv">
                <div class="mb-3">
                    <label for="pelangganMember" class="form-label">Pilih Pelanggan Member</label>
                    <select class="form-select" id="pelangganMember">
                        <option value="" disabled selected>Pilih Member</option>
                    </select>
                </div>
            </div>

            <!-- Pilih Produk -->
            <div class="mb-3">
                <label for="produk" class="form-label">Pilih Produk</label>
                <select class="form-select" id="produk">
                    <option value="" disabled selected>Pilih Produk</option>
                </select>
            </div>

            <!-- Jumlah Produk -->
            <div class="mb-3">
                <label for="jumlah" class="form-label">Jumlah</label>
                <input type="number" class="form-control" id="jumlah" placeholder="Masukkan jumlah produk">
            </div>

            <!-- Keranjang -->
            <button type="button" class="btn btn-secondary mb-3" id="tambahKeranjang">Tambah ke Keranjang</button>

            <h4>Keranjang</h4>
            <table class="table table-striped" id="keranjangTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Produk</th>
                        <th>Harga</th>
                        <th>Jumlah</th>
                        <th>Subtotal</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>

            <!-- Total -->
            <div class="mb-3">
                <label for="total" class="form-label">Total</label>
                <input type="number" class="form-control" id="total" readonly>
            </div>

            <!-- Metode Pembayaran -->
            <div class="mb-3">
                <label for="metodePembayaran" class="form-label">Metode Pembayaran</label>
                <select class="form-select" id="metodePembayaran" required>
                    <option value="Cash">Cash</option>
                    <option value="Transfer">Transfer</option>
                    <option value="QR">QR</option>
                    <option value="Ewallet">Ewallet</option>
                </select>
            </div>

            <!-- Jumlah Dibayar -->
            <div class="mb-3">
                <label for="bayar" class="form-label">Jumlah Dibayar</label>
                <input type="number" class="form-control" id="bayar" placeholder="Masukkan Jumlah Dibayar" required>
            </div>

            <!-- Bukti Pembayaran -->
            <div class="mb-3" id="buktiPembayaranDiv">
                <label for="buktiPembayaran" class="form-label">Upload Bukti Pembayaran</label>
                <input type="file" class="form-control" id="buktiPembayaran" accept=".jpg,.jpeg,.png,.pdf">
            </div>

            <button type="submit" class="btn btn-primary">Proses Transaksi</button>
        </form>

        <!-- Daftar Transaksi -->
        <h4 class="mt-5">Daftar Transaksi</h4>
        <table class="table table-striped" id="transaksiTable">
            <thead>
                <tr>
                    <th>#</th>
                    <th>ID Transaksi</th>
                    <th>Pelanggan</th>
                    <th>Total</th>
                    <th>Metode</th>
                    <th>Status</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const pelangganList = JSON.parse(localStorage.getItem('pelanggan')) || [];
        const produkList = JSON.parse(localStorage.getItem('produk')) || [];
        let keranjang = [];

        // Tampilkan input sesuai kategori pelanggan
        document.getElementById('kategoriPelanggan').addEventListener('change', function () {
            const kategori = this.value;
            document.getElementById('pelangganUmumDiv').style.display = kategori === 'Umum' ? 'block' : 'none';
            document.getElementById('pelangganMemberDiv').style.display = kategori === 'Member' ? 'block' : 'none';

            if (kategori === 'Member') {
                renderMemberOptions();
            }
        });

        function renderMemberOptions() {
            const pelangganMember = document.getElementById('pelangganMember');
            pelangganMember.innerHTML = '<option value="" disabled selected>Pilih Member</option>';
            pelangganList.forEach(member => {
                const option = document.createElement('option');
                option.value = JSON.stringify(member);
                option.textContent = `${member.nama} (ID: ${member.id})`;
                pelangganMember.appendChild(option);
            });
        }

        // Render produk dropdown
        function renderProduk() {
            const produkSelect = document.getElementById('produk');
            produkList.forEach(produk => {
                const option = document.createElement('option');
                option.value = JSON.stringify(produk);
                option.textContent = `${produk.nama} - Rp ${produk.harga}`;
                produkSelect.appendChild(option);
            });
        }

        renderProduk();

        // Tambahkan kode transaksi, keranjang, dan pembayaran di sini sesuai implementasi sebelumnya...
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
