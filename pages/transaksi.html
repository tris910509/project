<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaksi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <script>
        // Periksa peran pengguna
        const role = localStorage.getItem('userRole');
        const allowedRoles = ['Admin', 'Kasir'];
        if (!allowedRoles.includes(role)) {
            alert('Anda tidak memiliki akses ke halaman ini!');
            window.location.href = 'login.html';
        }
    </script>

    <div class="container mt-5">
        <h2 class="text-center">Transaksi</h2>

        <!-- Form Transaksi -->
        <h4>Tambah Transaksi</h4>
        <form id="transaksiForm" class="mb-4">
            <!-- Pilih Pelanggan -->
            <div class="mb-3">
                <label for="pelanggan" class="form-label">Pilih Pelanggan</label>
                <select class="form-select" id="pelanggan" required>
                    <option value="" disabled selected>Pilih Pelanggan</option>
                </select>
            </div>

            <!-- Pilih Produk -->
            <div class="mb-3">
                <label for="produk" class="form-label">Pilih Produk</label>
                <div class="row">
                    <div class="col-md-6">
                        <select class="form-select" id="produk">
                            <option value="" disabled selected>Pilih Produk</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <input type="number" id="jumlahProduk" class="form-control" placeholder="Jumlah" min="1">
                    </div>
                    <div class="col-md-3">
                        <button type="button" class="btn btn-secondary w-100" onclick="tambahKeKeranjang()">Tambah</button>
                    </div>
                </div>
            </div>

            <!-- Keranjang -->
            <h5>Keranjang Belanja</h5>
            <table class="table table-bordered mb-3">
                <thead>
                    <tr>
                        <th>Produk</th>
                        <th>Jumlah</th>
                        <th>Harga</th>
                        <th>Potongan</th>
                        <th>Subtotal</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="keranjangList"></tbody>
                <tfoot>
                    <tr>
                        <td colspan="4" class="text-end"><strong>Total</strong></td>
                        <td colspan="2" id="totalHarga">Rp 0</td>
                    </tr>
                </tfoot>
            </table>

            <!-- Metode Pembayaran -->
            <div class="mb-3">
                <label for="metodePembayaran" class="form-label">Metode Pembayaran</label>
                <select class="form-select" id="metodePembayaran" required>
                    <option value="" disabled selected>Pilih Metode Pembayaran</option>
                    <option value="Cash">Cash</option>
                    <option value="Transfer">Transfer</option>
                    <option value="QR">QR</option>
                    <option value="EWallet">E-Wallet</option>
                </select>
            </div>

            <!-- Bukti Pembayaran -->
            <div class="mb-3" id="buktiPembayaranContainer" style="display: none;">
                <label for="buktiPembayaran" class="form-label">Unggah Bukti Pembayaran</label>
                <input type="file" class="form-control" id="buktiPembayaran">
            </div>

            <!-- Jumlah Dibayar -->
            <div class="mb-3">
                <label for="bayar" class="form-label">Jumlah Dibayar</label>
                <input type="number" class="form-control" id="bayar" placeholder="Masukkan Jumlah Dibayar" required>
            </div>

            <button type="submit" class="btn btn-primary">Proses Transaksi</button>
        </form>

        <!-- Daftar Transaksi -->
        <h4>Daftar Transaksi</h4>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>ID Transaksi</th>
                    <th>Pelanggan</th>
                    <th>Produk</th>
                    <th>Metode</th>
                    <th>Total</th>
                    <th>Status</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody id="transaksiTable"></tbody>
        </table>
    </div>

    <script src="transaksi.js"></script>
</body>
</html>
